<!-- Filter Bar -->
<div class="filter-bar p-3 shadow-2 surface-0 flex align-items-center justify-content-between mb-3">
  <div class="p-field p-col-12 p-md-2">
      <label for="priceRange">Price Range:</label>
      <p-slider id="priceRange" [(ngModel)]="priceRange" [range]="true" [min]="0" [max]="10000" [style]="{width: '100%'}" (onChange)="onFilterChange()"></p-slider>
      <div class="flex justify-content-between mt-2">
          <span>{{priceRange[0]}} BD</span>
          <span>{{priceRange[1]}} BD</span>
      </div>
  </div>

  <div class="p-field p-col-12 p-md-2">
      <label for="city">City:</label>
      <p-dropdown id="city" [options]="cities" [(ngModel)]="selectedCity" placeholder="Select a City" (onChange)="onFilterChange()"></p-dropdown>
  </div>

  <div class="p-field p-col-12 p-md-2">
      <p-checkbox [(ngModel)]="hasWifi" binary="true" label="Wi-Fi" (onChange)="onFilterChange()"></p-checkbox>
  </div>

  <div class="p-field p-col-12 p-md-2">
      <p-checkbox [(ngModel)]="hasWaterElectricity" binary="true" label="Water & Electricity" (onChange)="onFilterChange()"></p-checkbox>
  </div>

  <div class="p-field p-col-12 p-md-2">
      <label for="sortOrder">Sort By:</label>
      <p-dropdown id="sortOrder" [options]="sortOptions" [(ngModel)]="selectedSortOrder" placeholder="Sort By" (onChange)="onFilterChange()"></p-dropdown>
  </div>

  <!-- Reset Filters Button -->
  <div class="p-field p-col-12 p-md-2">
    <button pButton type="button" label="Reset Filters" icon="pi pi-refresh" class="p-button-outlined p-button-secondary" (click)="resetFilters()">Reset</button>
  </div>
</div>

<!-- Loading Spinner -->
<div *ngIf="loading" class="flex justify-content-center align-items-center">
  <p-progressSpinner></p-progressSpinner>
</div>

<!-- Listings -->
<div *ngIf="!loading" class="grid">
  <div *ngFor="let listing of filteredListings" class="col-12 sm:col-6 lg:col-4 p-2">
    <p-card class="surface-card shadow-2 border-round" styleClass="listing-card">
      <ng-template pTemplate="header">
        <div class="image-container">
          <img
            [src]="listing.photo ? 'data:image/jpeg;base64,' + listing.photo : 'default-image-url.jpg'"
            alt="{{ listing.name }}"
            class="w-full h-full object-fit-cover border-round-top"
          />
        </div>
      </ng-template>
      <ng-template pTemplate="content">
        <div class="flex justify-content-between align-items-center mb-3">
          <h3 class="text-900 text-xl">{{ listing.name }}</h3>
          <span class="text-primary font-bold text-lg">{{ listing.price }} BD/Month</span>
        </div>
        <p class="mb-2"><i class="pi pi-map-marker mr-2 text-primary"></i>{{ listing.city }}, House {{ listing.houseNumber }}, Road {{ listing.roadNumber }}, Block {{ listing.blockNumber }}</p>
        <p class="mb-2"><i class="pi pi-wifi mr-2 text-primary"></i>Wi-Fi: {{ listing.wifi ? 'Yes' : 'No' }}</p>
        <p class="mb-2"><i class="pi pi-sliders-h mr-2 text-primary"></i>Water & Electricity: {{ listing.waterElectricity ? 'Yes' : 'No' }}</p>
        <p class="mb-2"><i class="pi pi-user mr-2 text-primary"></i>Listed By: {{ listing.userFirstName }} {{ listing.userLastName }}</p>
        <p class="mb-2"><i class="pi pi-envelope mr-2 text-primary"></i>Contact: {{ listing.userEmail }}, {{ listing.userPhoneNumber }}</p>
        <p class="mb-2"><i class="pi pi-calendar mr-2 text-primary"></i>Date Listed: {{ listing.createdAt | date:'medium' }}</p>
      </ng-template>
    </p-card>
  </div>
</div>
